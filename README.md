# hla_translation_tool
# üéÆ Half‚ÄëLife: Alyx Translation Tool

![Half‚ÄëLife: Alyx Translation Tool](https://img.shields.io/badge/Version-1.40.2-green?style=for-the-badge)
![HTML5](https://img.shields.io/badge/HTML5-E34F26?style=for-the-badge&logo=html5&logoColor=white)
![JavaScript](https://img.shields.io/badge/JavaScript-F7DF1E?style=for-the-badge&logo=javascript&logoColor=black)
![Offline](https://img.shields.io/badge/Offline-Ready-green?style=for-the-badge)

Eine vollst√§ndige **Offline‚ÄëWeb‚ÄëApp** zum Verwalten und √úbersetzen aller Audio‚ÄëZeilen aus *Half‚ÄëLife: Alyx*.

---

## üìã Inhaltsverzeichnis
* [Changelog](CHANGELOG.md)
* [üöÄ Features (komplett)](#-features-komplett)
* [üõ†Ô∏è Installation](#-installation)
* [ElevenLabs-Dubbing](#elevenlabs-dubbing)
* [üèÅ Erste Schritte](#-erste-schritte)
* [üéÆ Bedienung](#-bedienung)
* [‚å®Ô∏è Keyboard Shortcuts](#-keyboard-shortcuts)
* [üì• Import](#-import)
* [üìÅ Ordner-Management](#-ordner-management)
* [üîß Erweiterte Funktionen](#-erweiterte-funktionen)
* [üêõ Troubleshooting](#-troubleshooting)
---

## üöÄ Features (komplett)

### üéØ Kernfunktionen

* **Mehrere Projekte** mit Icon, Farbe, Level‚ÄëNamen & Teil‚ÄëNummer
* **Intelligenter Ordner‚ÄëScan** mit Duplikat‚ÄëPr√§vention und Auto‚ÄëNormalisierung
* **Eingebettete Audio‚ÄëWiedergabe** (MP3 / WAV / OGG) direkt im Browser
* **Live‚ÄëStatistiken:** EN‚Äë%, DE‚Äë%, Completion‚Äë%, Globale Textzahlen (EN/DE/BEIDE/‚àë)
* **Vollst√§ndig offline** ‚Äì keine Server, keine externen Abh√§ngigkeiten

### üìä Fortschritts‚ÄëTracking

* **Globale Dashboard‚ÄëKacheln:** Gesamt, √úbersetzt, Ordner komplett, **EN/DE/BEIDE/‚àë**
* **Level‚ÄëStatistik‚ÄëPanel** (aufklappbar im Ordner‚ÄëBrowser)
* **Projekt‚Äë√ºbergreifende Fortschrittsanzeige:** Dateien und Dashboard zeigen Status √ºber alle Projekte
* **Gr√ºne Rahmen** f√ºr **100 %**‚ÄëProjekte & vollst√§ndig √ºbersetzte Ordner
* **Dateizeilen‚ÄëBadges:** √úbersetzt / Ignoriert / Offen

### üìÅ Ordner‚ÄëManagement

* **Folder‚ÄëBrowser** mit Icons, Such‚Äë & Filter‚ÄëFunktionen
* **Pfad‚ÄëAnzeige:** Jede Datei zeigt aufgel√∂sten Pfad mit Status
* **Ignorieren‚ÄëToggle** f√ºr unn√∂tige Audios (üö´ Ignorieren / ‚Ü© Wieder aufnehmen)
* **Datenbank‚ÄëBereinigung:** Korrigiert falsche Ordnernamen automatisch
* **Ordner‚ÄëL√∂schfunktion:** Sichere Entfernung ganzer Ordner aus der DB
* **Live‚ÄëFilter:** *‚Äû√úbersetzt / Ignoriert / Offen"*
* **Ordner‚ÄëAnpassung:** Icons und Farben pro Ordner

### üñãÔ∏è Texteingabe & Navigation

* **Auto‚ÄëResize‚ÄëTextfelder** (EN & DE bleiben h√∂hengleich)
* **Sofort‚ÄëSpeicherung** nach 1 s Inaktivit√§t
* **Tab/Shift+Tab Navigation** zwischen Textfeldern und Zeilen
* **Ctrl+Leertaste:** Audio‚ÄëPlayback direkt im Textfeld
* **Copy‚ÄëButtons:** üìã neben jedem Textfeld f√ºr direktes Kopieren

### üîç Suche & Import

* **Erweiterte √Ñhnlichkeitssuche** (ignoriert Gro√ü‚Äë/Kleinschreibung, Punkte)
* **Intelligenter Import** mit automatischer Spalten‚ÄëErkennung
* **Multi‚ÄëOrdner‚ÄëAuswahl** bei mehrdeutigen Dateien
* **Live‚ÄëHighlighting** von Suchbegriffen

### ‚å®Ô∏è Keyboard & Maus

* **Keyboard‚ÄëNavigation:** Pfeiltasten, Tab, Leertaste f√ºr Audio, Enter f√ºr Texteingabe
* **Context‚ÄëMenu** (Rechtsklick): Audio, Kopieren, Einf√ºgen, Ordner √∂ffnen, L√∂schen
* **Drag & Drop:** Projekte und Dateien sortieren
* **Doppelklick:** Zeilennummer √§ndern, Projekt umbenennen

---

## üõ†Ô∏è Installation

1. **`web/hla_translation_tool.html`** herunterladen
2. **Datei lokal √∂ffnen** (Doppelklick) ‚Äì fertig!

> **üí° Tipp:** Desktop‚ÄëVerkn√ºpfung erstellen ‚áí Ein‚ÄëKlick‚ÄëStart

### Systemanforderungen

* **Moderner Browser:** Chrome, Firefox, Edge, Safari
* **JavaScript aktiviert**
* **Lokaler Dateizugriff** f√ºr Audio‚ÄëWiedergabe
* **Empfohlener Speicher:** 2+ GB freier RAM f√ºr gro√üe Projekte
* **Node.js 18‚Äì22** wird ben√∂tigt (u.a. f√ºr ElevenLabs-Dubbing; nutzt `fetch` und `FormData`)

### Desktop-Version (Electron)
1. Im Hauptverzeichnis `npm ci` ausf√ºhren, damit ben√∂tigte Pakete wie `chokidar` vorhanden sind
2. In das Verzeichnis `electron/` wechseln und `npm ci` ausf√ºhren. Fehlt npm (z.B. bei Node 22), `npm install -g npm` oder `corepack enable` nutzen
3. Mit `npm start` startet die Desktop-App ohne Browserdialog
4. Alternativ kann `start_tool.bat` (Windows), `start_tool.js` (plattformunabh√§ngig) oder `start_tool.py` (Python-Version) aus jedem Verzeichnis ausgef√ºhrt werden. Fehlt das Repository, wird es automatisch geklont; andernfalls werden die neuesten √Ñnderungen geladen und die Desktop-App gestartet. `start_tool.py` erkennt dabei automatisch, ob es im Repository oder davor gestartet wurde.
5. Beim Start werden die Ordner `web/sounds/EN` und `web/sounds/DE` automatisch erstellt und eingelesen
6. Kopieren Sie Ihre Originaldateien in `web/sounds/EN` und legen Sie √úbersetzungen in `web/sounds/DE` ab
7. W√§hrend des Setups erzeugen alle Skripte (`start_tool.bat`, `start_tool.js` und `start_tool.py`) die Logdatei `setup.log`, in der alle Schritte gespeichert werden. Bei Fehlern weist die Konsole nun explizit auf diese Datei hin. Die Logdatei wird vom Repository ausgeschlossen (`.gitignore`).
8. Die Skripte verwerfen lokale √Ñnderungen, **ohne** den Ordner `web/sounds` anzutasten ‚Äì Projektdaten bleiben somit erhalten
9. `node check_environment.js` prueft Node- und npm-Version, installiert Abhaengigkeiten und startet einen kurzen Electron-Test. Mit `--tool-check` fuehrt das Skript zusaetzlich `python start_tool.py --check` aus, um die Desktop-App kurz zu testen. Ergebnisse stehen in `setup.log`.
10. Alle Start-Skripte kontrollieren nun die installierte Node-Version und brechen bei Abweichungen ab.
11. Bei Problemen mit lokalen Aenderungen kann `reset_repo.py` diese verwerfen und das Repository aktualisieren.

### ElevenLabs-Dubbing

1. API-Schl√ºssel bei [ElevenLabs](https://elevenlabs.io) erstellen.
2. Den Schl√ºssel als Umgebungsvariable `ELEVEN_API_KEY` setzen oder beim Aufruf der Funktionen eingeben.
3. Kopieren Sie `.env.example` zu `.env.local` und tragen Sie Ihren Schl√ºssel in `ELEVEN_API_KEY=` ein.
4. Beispielhafte Nutzung (neue Reihenfolge):

```javascript
const { createDubbing, isDubReady } = require('./elevenlabs.js');
const apiKey = process.env.ELEVEN_API_KEY;
const job = await createDubbing({
    audioFile: 'web/sounds/EN/beispiel.wav',
    csvContent: csvData,
    voiceId: '',
    apiKey
});
const url = `https://elevenlabs.io/studio/dubbing/${job.dubbing_id}`;
console.log('Im Studio √∂ffnen:', url);
if (await isDubReady(job.dubbing_id, 'de', apiKey)) {
    const blob = await fetch(`${API}/dubbing/${job.dubbing_id}/audio/de`, { headers: { 'xi-api-key': apiKey } }).then(r => r.blob());
    // blob speichern ...
}
```

Ein Klick auf **Dubbing** √∂ffnet zun√§chst ein Einstellungsfenster. Dort lassen sich folgende Parameter anpassen:

* **Stability** ‚Äì Ausgeglichenheit vs. Lebendigkeit
* **Similarity-Boost** ‚Äì N√§he zum Original
* **Style** ‚Äì √úberzeichnung des Sprechstils
* **Speed** ‚Äì Tempo-Faktor
* **Speaker-Boost** ‚Äì zus√§tzliche √Ñhnlichkeit

Die Standardwerte werden √ºber `getDefaultVoiceSettings` geladen und nach dem Speichern dauerhaft im Browser hinterlegt.

Beim √ñffnen des Dubbing-Dialogs werden gespeicherte Werte automatisch geladen.
√úber den Button **Reset** lassen sich diese wieder auf die API-Defaults zur√ºcksetzen.

Nach erfolgreichem Download merkt sich das Projekt die zugeh√∂rige **Dubbing-ID** in der jeweiligen Datei (`dubbingId`).
So k√∂nnen Sie das Ergebnis sp√§ter erneut herunterladen oder neu generieren.

Ab Version 1.27.0 gibt es zus√§tzlich in der Dateitabelle einen Button **Download DE**.
Ist das Dubbing fertig, l√§sst sich damit die deutsche Audiodatei direkt speichern.
Ab Version 1.28.0 zeigt jede Zeile einen farbigen Punkt f√ºr den Dubbing‚ÄëStatus (grau/gelb/gr√ºn).
Ab Version 1.29.0 gibt es ein erweitertes Protokoll aller API-Aufrufe.
Ab Version 1.30.0 werden Fehler beim Starten des Dubbings als roter Toast angezeigt und der Status wird alle 60 Sekunden automatisch aktualisiert.
Ab Version 1.31.0 speichert das Tool manuell heruntergeladene Audios im neuen Ordner `Download`.
Ab Version 1.32.0 versucht das Tool automatisch, die gerenderte Datei √ºber die Resource-API herunterzuladen.
Ab Version 1.33.0 √ºberwacht das Tool den Download-Ordner und importiert Dateien automatisch.
Ab Version 1.34.1 verwendet das Tool `path.resolve` f√ºr alle Pfade und meldet "Spur manuell generieren oder Beta freischalten" bei fehlendem Download.
Ab Version 1.34.2 behebt die Desktop-Version ein fehlendes `chokidar`-Modul.
Ab Version 1.34.3 installieren die Start-Skripte automatisch die Haupt-Abh√§ngigkeiten.
Ab Version 1.34.4 √∂ffnet der Button "Ordner √∂ffnen" den Backup-Ordner auch im Browser.
Ab Version 1.34.5 erkennt das Tool auch Backups im alten Ordner `backups`.
Ab Version 1.35.0 lassen sich Backups im Browser hochladen und wiederherstellen.
Seit Version 1.35.2 √∂ffnet der Dev-Button zus√§tzlich die eingebaute Debug-Konsole.
Ab Version 1.35.3 wird der Ordner `sounds` automatisch erkannt.
Ab Version 1.35.4 zeigt der Dev-Button nun JavaScript-Fehler in der Debug-Konsole an.
Ab Version 1.35.5 wurden √ºberfl√ºssige TypeScript-Dateien entfernt.

Ab Version 1.36.0 liegen alle Web-Dateien im Ordner `web/`.
Ab Version 1.36.1 werden die lokalen Ordner `web/sounds`, `web/backups` und `web/Download` ignoriert.
Ab Version 1.36.2 verwerfen die Start-Skripte beim Zur√ºcksetzen auch keine Backups mehr.
Ab Version 1.36.3 erkennt die Desktop-Version auch Ordner mit gro√üem Anfangsbuchstaben.
Ab Version 1.36.4 entfernen die Start-Skripte automatisch √ºberfl√ºssige Dateien (ohne `web/sounds` und `web/backups`).
Ab Version 1.36.6 erscheint beim Debug-Button ein Hinweis, wenn die Electron-API fehlt.
Ab Version 1.36.7 zeigt das Debug-Fenster einen Kopierknopf f√ºr alle Informationen.
Ab Version 1.36.8 startet Electron immer mit aktivierter Context Isolation.
Ab Version 1.36.9 zeigt das Debug-Fenster zus√§tzliche Browser- und Prozessinformationen.
Ab Version 1.36.10 h√§lt das Python-Startskript das Fenster nach Abschluss offen.
Ab Version 1.36.11 gibt das Python-Startskript bei einem Fehler von `npm start` eine verst√§ndliche Meldung aus und schreibt sie in `setup.log`.
Ab Version 1.36.12 protokollieren die Start-Skripte die UID und ob Electron mit oder ohne Sandbox startet.
Ab Version 1.37.0 zeigt das Debug-Fenster weitere Systeminformationen wie Fenstergr√∂√üe und Sandbox-Status an.
Ab Version 1.37.1 kann `start_tool.py` sowohl im Repository-Ordner als auch davor gestartet werden.
Ab Version 1.37.2 pruefen `start_tool.py` und `start_tool.js`, ob Node 18‚Äì21 installiert ist.
Die Meldung "Electron-API nicht verf√ºgbar" weist darauf hin, dass das Tool im Browser ausgef√ºhrt wird. Pfad-Informationen sind nur in der Desktop-Version sichtbar.
F√ºr diesen Zweck gibt es das Node-Skript `cliRedownload.js`.
Es wird so aufgerufen:

```bash
node cliRedownload.js <API-Key> <Dubbing-ID> <Ausgabedatei> [Sprache]
```

Intern nutzt es `downloadDubbingAudio()` aus `elevenlabs.js`.

√úber das **API-Men√º** l√§sst sich zudem pro Ordner eine feste ElevenLabs-Stimme w√§hlen. Ist eine Voice-ID hinterlegt, wird sie beim Dubbing automatisch genutzt und Voice Cloning abgeschaltet. Ohne Voice-ID bleibt Voice Cloning aktiv.

Ab Version 1.10.3 wird beim Dubbing der selbst eingetragene deutsche Text genutzt. Das Tool erzeugt dazu eine CSV-Datei mit dem Format `speaker,start_time,end_time,transcription,translation`. Die Felder `start_time` und `end_time` enthalten seit Version 1.18.6 Sekundenwerte mit drei Nachkommastellen und leiten sich aus `trimStartMs` bzw. `trimEndMs` ab. Diese CSV wird zusammen mit `mode=manual` und `dubbing_studio=true` an die API √ºbermittelt.

Bis Version 1.19.1 nutzte das Tool den Studio-Workflow √ºber `resource/dub` und `resource/render`. Ab Version 1.19.2 erfolgt das Dubbing ausschlie√ülich √ºber die Standard-Endpunkte: Nach `POST /v1/dubbing` wird regelm√§√üig `GET /v1/dubbing/<ID>` aufgerufen und das Ergebnis anschlie√üend via `GET /v1/dubbing/<ID>/audio/<sprache>` heruntergeladen.

Ab Version 1.20.3 wertet `waitForDubbing` nur noch `status` aus. Angaben in `progress.langs` oder `state` werden ignoriert.

Ab Version 1.24.0 entf√§llt `renderLanguage`. Erzeugte Projekte werden im Studio manuell gerendert. `isDubReady(id)` pr√ºft dabei, ob die deutsche Spur bereitsteht.

Beispiel einer g√ºltigen CSV:

```csv
speaker,start_time,end_time,transcription,translation
0,0.000,1.000,"Hello","Hallo"
```
*Hinweis:* Die Datei schlie√üt mit CRLF (`\r\n`). Vor dem Upload pr√ºft das Tool, dass ein Zeilenumbruch vorhanden ist und alle Felder korrekt in Anf√ºhrungszeichen stehen.

### Dubbing-Protokoll

Nach jedem Start eines Dubbing-Vorgangs √∂ffnet sich automatisch das Fenster **Dubbing-Protokoll**. Dort sind jetzt ausf√ºhrliche Fehlermeldungen sichtbar, inklusive HTTP-Code und Server-Antwort. Das Protokoll l√§sst sich jederzeit √ºber den Schlie√üen-Button beenden oder kopieren.
Bei einem Upload-Fehler mit Status 400 wird zus√§tzlich ein Ausschnitt der erzeugten CSV angezeigt. So l√§sst sich schnell pr√ºfen, ob die Daten korrekt formatiert sind.
Ab Version 1.20.2 protokolliert das Fenster zudem `detail.message` und `error` aus der Server-Antwort.

### Version aktualisieren

1. In `package.json` die neue Versionsnummer eintragen.
2. Danach `npm run update-version` ausf√ºhren. Das Skript aktualisiert `electron/package.json` und ersetzt alle `1.40.2`-Platzhalter in `README.md`, `web/src/main.js` und `web/hla_translation_tool.html` durch die aktuelle Nummer.

---

## üèÅ Erste Schritte

### 1. üìÅ Programm starten
* Beim Start liest die App automatisch alle Audio‚ÄëDateien aus `web/sounds/EN` und vorhandene √úbersetzungen aus `web/sounds/DE` ein

### 2. üìÇ Neues Projekt erstellen
* Klicken Sie auf **‚Äû+ Neues Projekt"**
* Vergeben Sie einen Namen
* Optional: Level‚ÄëName und Teil‚ÄëNummer angeben
* Icon und Farbe werden automatisch zugewiesen

### 3. üìÑ Dateien hinzuf√ºgen
* **√úber Suche:** Live‚ÄëSuche nach Dateinamen oder Textinhalten
* **√úber Browser:** ‚ÄûüìÅ Ordner durchsuchen" f√ºr visuelles Browsen
* **Direct‚ÄëInput:** Dateinamen direkt ins Eingabefeld

### 4. ‚úèÔ∏è √úbersetzen
* Englische Texte werden automatisch erkannt
* Deutsche √úbersetzung in das DE‚ÄëFeld eingeben
* **‚úì Fertig‚ÄëCheckbox** setzen f√ºr Completion‚ÄëTracking
* Auto‚ÄëSave speichert alle 1 Sekunde

---

## üéÆ Bedienung

### Projekt‚ÄëManagement

|  Aktion                    |  Bedienung                                          |
| -------------------------- | --------------------------------------------------- |
| **Projekt erstellen**     | `+ Neues Projekt` Button                          |
| **Projekt ausw√§hlen**     | Klick auf Projekt‚ÄëKachel                          |
| **Projekt anpassen**      | ‚öôÔ∏è auf Projekt‚ÄëKachel ‚Üí Icon, Farbe, Level        |
| **Projekt l√∂schen**       | √ó auf Projekt‚ÄëKachel                              |
| **Projekt umbenennen**    | Doppelklick auf Projekt‚ÄëName                      |
| **Projekt sortieren**     | Drag & Drop der Projekt‚ÄëKacheln                   |
| **Level‚ÄëName kopieren**   | ‚ßâ‚ÄëButton in Meta‚ÄëLeiste                           |

### Datei‚ÄëManagement

|  Aktion                    |  Bedienung                                          |
| -------------------------- | --------------------------------------------------- |
| **Dateien suchen**        | Live‚ÄëSuchfeld (mind. 2 Zeichen)                   |
| **Dateien hinzuf√ºgen**    | Direct‚ÄëInput, Suchresultat‚ÄëKlick, Browser         |
| **Datei als fertig**      | ‚úì Completion‚ÄëCheckbox                             |
| **Datei ignorieren**      | üö´ Ignorieren‚ÄëButton (im Ordner‚ÄëBrowser)          |
| **Position √§ndern**       | Doppelklick auf Zeilennummer (#)                  |
| **Sortierung √§ndern**     | Klick auf Spalten‚ÄëHeader                          |
| **Datei l√∂schen**         | √ó am Zeilenende oder Context‚ÄëMenu                 |

### Audio & Text

|  Aktion                    |  Bedienung                                          |
| -------------------------- | --------------------------------------------------- |
| **Audio abspielen**       | ‚ñ∂ Button oder Leertaste (bei ausgew√§hlter Zeile)  |
| **Audio im Textfeld**     | `Ctrl + Leertaste`                                |
| **Text kopieren**         | üìã Button neben Textfeld                          |
| **Zwischen Feldern**      | `Tab` / `Shift + Tab`                             |
| **Auto‚ÄëResize aktiviert** | Textfelder passen sich automatisch an            |

---

## ‚å®Ô∏è Keyboard Shortcuts

### Globale Shortcuts

|  Tastenkombination         |  Funktion                                           |
| -------------------------- | --------------------------------------------------- |
| **`Ctrl + S`**            | Projekt manuell speichern                         |
| **`Ctrl + I`**            | Import‚ÄëDialog √∂ffnen                              |
| **`Escape`**              | Dialoge schlie√üen / Context‚ÄëMenu schlie√üen        |

### Tabellen‚ÄëNavigation

|  Taste                     |  Funktion                                           |
| -------------------------- | --------------------------------------------------- |
| **`‚Üë` / `‚Üì`**             | Zeile nach oben/unten                             |
| **`Tab` / `Shift+Tab`**   | Zwischen Textfeldern wechseln                     |
| **`Enter`**               | Erstes Textfeld der ausgew√§hlten Zeile fokussieren |
| **`Leertaste`**           | Audio der ausgew√§hlten Zeile abspielen            |
| **`Delete`**              | Ausgew√§hlte Zeile l√∂schen                         |

### Text‚ÄëShortcuts

|  Tastenkombination         |  Funktion                                           |
| -------------------------- | --------------------------------------------------- |
| **`Ctrl + Leertaste`**    | Audio abspielen (im Textfeld)                     |
| **`Tab`**                 | N√§chstes Textfeld                                 |
| **`Shift + Tab`**         | Vorheriges Textfeld                               |

---

## üì• Import

### Import‚ÄëFunktionen

* **üì• Daten importieren**
  * **Wiki‚ÄëTabellen:** Automatische Spalten‚ÄëErkennung
  * **Pipe‚ÄëFormat:** `Dateiname|EN Text|DE Text`
  * **Intelligente Zuordnung:** Dateinamen‚ÄëSpalte wird automatisch erkannt
  * **Multi‚ÄëOrdner‚ÄëSupport:** Auswahl bei mehrdeutigen Dateien
  * **Database‚ÄëMatching:** Vergleich mit vorhandenen Audiodateien

---

## üìÅ Ordner‚ÄëManagement

### Ordner‚ÄëBrowser Features

* **üìä Globale Statistiken:** √úbersetzungsfortschritt √ºber alle Projekte
* **üìà Level‚ÄëStatistiken:** Aufklappbares Panel mit Details pro Level
* **üé® Ordner‚ÄëAnpassung:** Icons und Farben individuell einstellbar
* **üîç Pfad‚ÄëAnzeige:** Status und aufgel√∂ster Pfad f√ºr jede Datei
* **‚úÖ Completion‚ÄëStatus:** Visuelle Markierung √ºbersetzter Dateien

### Ordner‚ÄëAktionen

|  Aktion                    |  Beschreibung                                       |
| -------------------------- | --------------------------------------------------- |
| **üö´ Ignorieren**         | Datei als ‚Äûnicht ben√∂tigt" markieren              |
| **‚Ü© Wieder aufnehmen**    | Ignorierte Datei wieder aktivieren                |
| **+ Hinzuf√ºgen**          | Datei zum aktuellen Projekt hinzuf√ºgen            |
| **‚ñ∂ Audio abspielen**     | Direkte Wiedergabe im Browser                     |
| **‚öôÔ∏è Ordner anpassen**    | Icon und Farbe des Ordners √§ndern                 |
| **‚ùå Ordner l√∂schen**     | Kompletten Ordner aus Datenbank entfernen         |

### Datenbank‚ÄëWartung

* **üßπ Ordnernamen bereinigen:** Korrigiert falsche Pfade automatisch
* **üßπ Duplikate bereinigen:** Intelligente Zusammenf√ºhrung √§hnlicher Eintr√§ge
* **üîÑ Projekte bereinigen:** Entfernt veraltete Pfad‚ÄëReferenzen
* **üîß Ordner reparieren:** Aktualisiert Ordnernamen in allen Projekten

Diese Wartungsfunktionen findest du nun gesammelt im neuen **‚öôÔ∏è Einstellungen**‚ÄëKnopf oben rechts.

---

## üîß Erweiterte Funktionen

### Auto‚ÄëScan‚ÄëSystem

* **üîÑ Universeller Auto‚ÄëScan:** Alle Funktionen l√∂sen bei Bedarf automatisch Ordner‚ÄëScan aus
* **‚ö° Berechtigung‚ÄëErkennung:** Browser‚ÄëBerechtigungen werden automatisch gepr√ºft
* **üéØ Intelligente Pfad‚ÄëAufl√∂sung:** Dynamisches Matching zwischen Projekten und Datenbank

### Erweiterte Suche

* **üîç √Ñhnlichkeitssuche:** Ignoriert Gro√ü‚Äë/Kleinschreibung, Punkte, Kommas
* **üìä Relevanz‚ÄëScoring:** Beste Treffer werden priorisiert
* **üéØ Multi‚ÄëKriterien:** Dateiname, EN‚ÄëText, DE‚ÄëText werden durchsucht
* **üìã Live‚ÄëHighlighting:** Suchbegriffe werden in Ergebnissen hervorgehoben

### Intelligente Features

* **üß† Smart Folder Detection:** Erkennt Half‚ÄëLife Charaktere automatisch
* **üìè Auto‚ÄëHeight Textboxen:** EN/DE Felder bleiben h√∂hengleich
* **üé® Theme‚ÄëSystem:** Automatische Icon‚Äë und Farb‚ÄëZuweisungen
* **üí° Context‚ÄëAwareness:** Funktionen passen sich dem aktuellen Kontext an

---

## üêõ Troubleshooting

### H√§ufige Probleme

**üéµ Audio spielt nicht ab**
* ‚ñ∂ **L√∂sung:** Audiodateien erneut einlesen, falls Berechtigungen fehlen
* ‚ñ∂ **Automatisch:** Tool pr√ºft beim Start, ob Dateien verf√ºgbar sind

**üìÅ Dateien nicht gefunden**
* ‚ñ∂ **L√∂sung:** Haupt‚ÄëAudio‚ÄëOrdner erneut einlesen
* ‚ñ∂ **Pr√ºfung:** Debug‚ÄëSpalte zeigt Pfad‚ÄëStatus

**‚ö†Ô∏è Spur manuell generieren oder Beta freischalten**
* ‚ñ∂ **Ursache:** Die gew√§hlte Sprachspur konnte nicht automatisch heruntergeladen werden.
* ‚ñ∂ **L√∂sung:** Spur im Studio manuell generieren oder Beta-Zugang f√ºr den Auto-Download freischalten.

**‚ùì target_lang nicht gesetzt?**
* ‚ñ∂ **Hinweis:** Diese Meldung erscheint, wenn `waitForDubbing` im Fortschritt keine Zielsprache findet.


**üîÑ Duplikate in Datenbank**
* ‚ñ∂ **L√∂sung:** ‚Äûüßπ Duplikate bereinigen" verwenden
* ‚ñ∂ **Intelligente Bereinigung:** Beh√§lt beste Versionen automatisch

### Debug‚ÄëTools

* **üîç Debug‚ÄëSpalte:** Zeigt aufgel√∂ste Pfade und Status
* **üìä Datenquellen‚ÄëAnalyse:** Console‚ÄëLogs f√ºr Entwickler
* **üéØ Access‚ÄëStatus:** Echtzeit‚ÄëAnzeige der Dateiberechtigungen
* **üîß Debug-Konsole:** √úber das Dropdown "Debug-Konsole" k√∂nnen Sie Logs einsehen. In der Desktop-Version √∂ffnen Sie mit `npm start -- --debug` oder per `Ctrl+Shift+I` die DevTools.
* **üìù Ausf√ºhrliche API-Logs:** Alle Anfragen und Antworten werden im Dubbing-Log protokolliert

### Performance‚ÄëTipps

* **üìÇ Ordner‚ÄëStruktur:** Verwenden Sie sinnvolle Ordner‚ÄëHierarchien
* **üßπ Regelm√§√üige Bereinigung:** Duplikate und veraltete Eintr√§ge entfernen
* **üíæ Backup‚ÄëStrategie:** Regelm√§√üige Datensicherung vor gr√∂√üeren √Ñnderungen

---
## üìù Changelog

Der komplette Verlauf steht in [CHANGELOG.md](CHANGELOG.md).

## üí° Tipps & Best Practices

### Projekt‚ÄëOrganisation

* **üìã Level‚ÄëNamen verwenden:** Strukturieren Sie Projekte nach Spiel‚ÄëLeveln
* **üî¢ Teil‚ÄëNummern vergeben:** F√ºr gro√üe Level mehrere Teile erstellen
* **üé® Farb‚ÄëCoding:** √Ñhnliche Level mit gleichen Farben markieren

### √úbersetzungs‚ÄëWorkflow

1. **üìÅ Dateien werden beim Start geladen** ‚Äì kein manuelles Scannen n√∂tig
2. **üîç Suche verwenden** statt manueller Datei‚ÄëEingabe
3. **üéµ Audio anh√∂ren** vor √úbersetzung
4. **‚úì Fertig‚ÄëStatus setzen** f√ºr Fortschritts‚ÄëTracking
5. **üíæ Regelm√§√üige Backups** erstellen

### Performance‚ÄëOptimierung

* **üßπ Duplikate bereinigen** bei gro√üen Datenbanken
* **üö´ Unn√∂tige Dateien ignorieren** f√ºr bessere √úbersicht
* **üìä Level‚ÄëStatistiken nutzen** f√ºr Fortschritts‚Äë√úbersicht

---

¬© 2025 Half‚ÄëLife: Alyx Translation Tool ‚Äì Alle Rechte vorbehalten.

**Version 1.27.0 - Download-Button**
Neue Spalte mit "Download DE" erm√∂glicht schnellen Zugriff auf fertige Dubbings.

**Version 1.28.0 - Dubbing-Status**
Jede Dateizeile enth√§lt nun einen farbigen Punkt f√ºr den aktuellen Dubbing-Status.

**Version 1.29.0 - Protokoll-Men√º**
Neues Protokoll-Men√º zeigt alle API-Aufrufe mit Statuscode an.

**Version 1.30.0 - Fehler- und UX-Feinschliff**
Dubbing-Fehler erscheinen sofort in einem roten Toast. Gelbe Status-Icons werden alle 60 Sekunden automatisch gepr√ºft.

**Version 1.31.0 - Doppel-Workflow**
Neuer Ordner `Download` f√ºr manuelle Audios, der beim Start erstellt wird.
**Version 1.32.0 - Beta-Auto-Download**
Automatisches Herunterladen √ºber die Resource-API, sofern freigeschaltet.
**Version 1.33.0 - Ordner√ºberwachung**
Automatisches Erkennen und Importieren manuell gespeicherter Audios.
**Version 1.34.0 - Neuer Dub-Status**
Status-Spalte zeigt nun graue, gelbe oder gr√ºne Punkte. Ein Klick auf Gelb √∂ffnet das Studio erneut.
**Version 1.34.1 - Pfad-Fixes & Clean-Up**
Alle Pfade nutzen nun `path.resolve`. Bei fehlenden Dubbings erscheint die Meldung ‚ÄûSpur manuell generieren oder Beta freischalten‚Äú. Nach dem Import wird die Quelldatei entfernt.
**Version 1.34.2 - Chokidar-Fix**
Behebt ein fehlendes `chokidar`-Modul in der Desktop-Version.
**Version 1.34.3 - Auto-Install**
Start-Skripte f√ºhren nun `npm ci` im Hauptordner aus.
**Version 1.34.4 - Backup-Fallback**
Der Backup-Button √∂ffnet nun auch im Browser den `backups`-Ordner.
**Version 1.34.5 - Backup-Kompatibilit√§t**
Backups aus dem alten Ordner `backups` werden wieder erkannt.
**Version 1.35.2 - Dev-Button zeigt Debug-Konsole**
Der Dev-Button √∂ffnet nun die eingebaute Debug-Konsole und in der Desktop-Version zus√§tzlich die DevTools.
**Version 1.35.3 - Fester Sounds-Pfad**
Die Browser-Version nutzt nun automatisch den Ordner `web/sounds` neben der HTML-Datei.
**Version 1.35.4 - Besseres Debugging**
Der Dev-Button √∂ffnet die Debug-Konsole jetzt automatisch und zeigt JavaScript-Fehler an.
**Version 1.35.5 - Aufr√§umarbeiten**
Nicht ben√∂tigte TypeScript-Dateien wurden entfernt.
**Version 1.36.1 - Gitignore-Anpassung**
Ignoriert jetzt die lokalen Ordner `web/sounds`, `web/backups` und `web/Download`.
**Version 1.36.2 - Sicheres Reset**
Die Start-Skripte lassen beim Zur√ºcksetzen auch den Ordner `web/backups` unver√§ndert.
**Version 1.36.3 - Gro√ü-/Kleinschreibung**
Die Desktop-Version erkennt nun auch `web/Sounds` und `web/Backups`.
**Version 1.36.4 - Automatische Bereinigung**
Die Start-Skripte entfernen nicht mehr ben√∂tigte Dateien. `web/sounds` und `web/backups` bleiben dabei erhalten.
**Version 1.36.5 - Neues Debug-Fenster**
Der Debug-Button zeigt nun eine √úbersicht der erwarteten Pfade.
**Version 1.36.6 - Browser-Hinweis**
Fehlt die Electron-API, erscheint nun ein erkl√§render Hinweis.
**Version 1.36.7 - Kopierknopf**
Das Debug-Fenster bietet nun einen Button zum Kopieren aller Informationen.
**Version 1.36.8 - Context Isolation**
Electron startet jetzt immer mit aktiver Context Isolation.
**Version 1.36.9 - Mehr Debug-Daten**
Das Debug-Fenster zeigt nun zus√§tzliche Browser- und Prozessinformationen an.

**Version 1.36.12 - Mehr Debug-Infos**
Die Start-Skripte protokollieren jetzt die UID und melden, ob Electron mit oder ohne Sandbox startet.
**Version 1.37.0 - Extremes Debug-Fenster**
Das Debug-Fenster liefert nun zus√§tzliche Informationen wie Fenstergr√∂√üe, Bildschirmaufl√∂sung und den Sandbox-Status.
**Version 1.37.1 - Flexibler Start**
`start_tool.py` erkennt nun automatisch, ob es im Repository oder im dar√ºberliegenden Ordner ausgef√ºhrt wird.
**Version 1.37.2 - Node-Pruefung**
`start_tool.py` und `start_tool.js` stellen sicher, dass Node 18‚Äì21 verwendet wird.
**Version 1.37.3 - Aktualisiertes Node-Fenster**
`package.json` erwartet jetzt Node 18‚Äì21.
**Version 1.37.4 - Node 22-Unterst√ºtzung**
`start_tool.py` und `start_tool.js` akzeptieren nun Node 22.
**Version 1.37.6 - Verbesserte Installation**
Start-Skripte nutzen nun `npm ci` statt `npm install`.
**Version 1.37.5 - Electron-Fallback**
Fehlt nach `npm ci` das Electron-Modul, wird es automatisch nachinstalliert.
**Version 1.38.0 - Check Environment**
Neues Skript `check_environment.js` prueft Node-Version, installiert Abhaengigkeiten und testet Electron.
**Version 1.38.1 - Einfacherer Reset**
`git reset --hard HEAD` entfernt lokale √Ñnderungen, ohne `web/sounds` und `web/backups` anzutasten.
**Version 1.38.4 - Zuverlaessiger Environment-Check**
`check_environment.js` stellt nach `npm ci` sicher, dass das Electron-Modul vorhanden ist und installiert es sonst nach.
**Version 1.38.5 - Python-App-Test**
`check_environment.js` kann jetzt mit `--tool-check` einen kurzen Start der Desktop-App per `python start_tool.py --check` ausfuehren.
**Version 1.38.6 - Erweiterte Debug-Infos**
Das Debug-Fenster zeigt nun ausf√ºhrliche System- und Pfadinformationen sowie die letzten Zeilen aus `setup.log`.
**Version 1.38.7 - Admin-Erkennung**
Das Debug-Fenster informiert nun, ob das Programm mit Administratorrechten l√§uft.
**Version 1.38.8 - Programmversionen**
Das Debug-Fenster listet jetzt App-, Node-, Electron- und Chrome-Version auf.
**Version 1.38.3 - Node-Check in start_tool.bat**
Die Batch-Datei prueft nun die installierte Node-Version und verlangt Node 18 bis 22.
**Version 1.38.2 - Zuverlaessiges Electron-Modul**
Nach `npm ci` pruefen die Start-Skripte, ob `electron/node_modules/electron` fehlt und installieren das Modul bei Bedarf nach. Schlaegt dies erneut fehl, bricht das Skript mit einer Fehlermeldung ab.
**Version 1.36.11 - Bessere Fehleranzeige**
Beim Starten der Anwendung erscheint nun eine verst√§ndliche Meldung, falls `npm start` fehlschl√§gt. Der Fehler wird zus√§tzlich in `setup.log` protokolliert.

**Version 1.36.10 - Stopp bei Fehlermeldungen**
Das Python-Startskript h√§lt das Fenster nach Abschluss offen, sodass man Fehler besser erkennen kann.

**Version 1.35.0 - Backup-Upload**
Backups k√∂nnen im Browser hochgeladen und sofort wiederhergestellt werden.
**Version 1.26.0 - Studio-Workflow**
√ñffnet nach jedem Dubbing automatisch das ElevenLabs Studio und zeigt einen Hinweis mit OK-Button an.


**Version 1.25.0 - API-Bereinigung
üéÆ Speziell entwickelt f√ºr Half‚ÄëLife: Alyx √úbersetzungsprojekte

## üß™ Tests

Diese Repository nutzt **Jest** als Test Runner. Um die Tests auszuf√ºhren:
Ein neuer GitHub-Workflow (`node-test.yml`) f√ºhrt nach jedem Push oder Pull Request automatisch `npm ci` und `npm test` mit Node 18 bis 22 aus.

`npm test` installiert dank eines `pretest`-Skripts automatisch alle Abh√§ngigkeiten per `npm ci`.

1. Tests starten
   ```bash
   npm test
   ```

Die wichtigsten Tests befinden sich im Ordner `tests/` und pr√ºfen unter
anderem die Funktion `calculateProjectStats`. Neu sind Tests f√ºr die
ElevenLabs‚ÄëAnbindung (z.‚ÄØB. `getDubbingStatus`) und `manualDub.test.js`, der `csv_file` und `voice_id` √ºberpr√ºft. Zudem pr√ºft ein Test `showDubbingSettings`, ob der Dialog im DOM erscheint. Ebenfalls neu ist `watcher.test.js`, der das Anlegen einer Datei im Download‚ÄëOrdner simuliert und den entsprechenden Callback testet.
Ab Version 1.40.3 nutzt `manualDub.test.js` einen kleinen Polyfill, damit der `File`-Konstruktor auch in Node-Umgebungen verf√ºgbar ist.
Ab Version 1.40.4 funktioniert der Dev-Button wieder in jeder Version, weil seine Funktion global bereitsteht.
Ab Version 1.40.5 f√ºhrt das `pretest`-Skript nun `npm ci` statt `npm install` aus.

## ‚ñ∂Ô∏è E2E-Test

1. **Entwicklungsserver starten**
   ```bash
   npm start
   ```
2. **Audiodatei hochladen** ‚Äì im ge√∂ff¬≠neten Tool eine WAV‚Äë oder MP3‚ÄëDatei ausw√§hlen.
3. **Logs pr√ºfen** ‚Äì in der Konsole erscheinen Meldungen zu Upload und Dubbing.
4. **Audio anh√∂ren** ‚Äì nach Abschluss wird die generierte Sprachausgabe abgespielt.

**Erfolgskriterien**

* Ausgabe erfolgt auf Deutsch.
* Timing der Sprachausgabe passt zum Original.

## üß© Wichtige Funktionen

* **`readAudioFiles(dir)`** ‚Äì liest alle Audiodateien eines Ordners rekursiv ein und gibt ihre Pfade im POSIX‚ÄëFormat zur√ºck.
* **`createWindow()`** ‚Äì √∂ffnet das Hauptfenster der Electron‚ÄëApp und richtet einen Shortcut zum Ein‚Äë/Ausblenden der DevTools ein.
* **`backup-de-file(relPath)`** ‚Äì kopiert eine vorhandene deutsche Audiodatei nach `DE-Backup`, sofern dort noch keine Sicherung existiert.
* **`delete-de-backup-file(relPath)`** ‚Äì l√∂scht eine Sicherung aus `DE-Backup` und entfernt leere Unterordner.
* **`restore-de-file(relPath)`** ‚Äì stellt eine deutsche Audiodatei aus dem Backup wieder her.
* **`calculateProjectStats(project)`** ‚Äì ermittelt pro Projekt den √úbersetzungs‚Äë und Audio‚ÄëFortschritt. Diese Funktion wird auch in den Tests ausf√ºhrlich gepr√ºft.
